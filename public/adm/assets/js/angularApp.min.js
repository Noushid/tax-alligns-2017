var app=angular.module("myApp",["ngRoute","ui.bootstrap","angularUtils.directives.dirPagination","ngFileUpload"]);app.config(["$routeProvider","$locationProvider",function(e,a){a.hashPrefix(""),e.when("/",{}).when("/dashboard",{templateUrl:"dashboard",controller:"dashboardController"}).when("/gallery",{templateUrl:"gallery",controller:"galleryController"}).when("/user-profile",{templateUrl:"change"})}]),app.filter("startFrom",function(){return function(e,a){return a=+a,e.slice(a)}}),app.directive("ngConfirmClick",[function(){return{link:function(e,a,n){var o=n.ngConfirmClick||"Are you sure?",t=n.confirmedClick;a.bind("click",function(a){window.confirm(o)&&e.$eval(t)})}}}]),app.controller("adminController",["$scope","$location","$http","$rootScope","$filter","$window","uibDateParser","$uibModal","$log","$document",function(e,a,n,o,t,l,r,i,s,d){function u(){var a=o.base_url+"admin/user";n.get(a).then(function(a){a.data&&(e.curuser=a.data.username,e.newuser.username=e.curuser)})}function c(a,n,o){var t=o?angular.element(d[0].querySelector(".modal-demo "+o)):void 0;i.open({animation:e.animationsEnabled,templateUrl:"myModalContent.html",controller:"ModalInstanceCtrl",controllerAs:"$scope",size:n,appendTo:t,resolve:{items:function(){return a}}}).result.then(function(a){e.selected=a},function(){s.info("Modal dismissed at: "+new Date)})}e.error={};var f=e.baseUrl=a.protocol()+"://"+location.host+"/";o.base_url=f,o.public_url=e.baseUrl=a.protocol()+"://"+location.host,e.paginations=[5,10,20,25],e.numPerPage=10,e.user={},e.curuser={},e.newuser={},e.newuser={},o.loading=!1,e.formdisable=!1,o.loading=!1,e.format="yyyy/MM/dd",e.login=function(){console.log("login");var a=new FormData;angular.forEach(e.user,function(e,n){a.append(n,e)});var t=o.base_url+"login/verify";n.post(t,a,{transformRequest:angular.identity,headers:{"Content-Type":void 0,"Process-Data":!1}}).then(function(e){l.location.href=f+"admin/#/"},function(a){console.log("login error"),console.log(a.data),e.error=a.data,e.showerror=!0})},e.changeProfile=function(){o.loading=!0;var a=new FormData;angular.forEach(e.newuser,function(e,n){a.append(n,e)});var t=o.base_url+"admin/change/submit";n.post(t,a,{transformRequest:angular.identity,headers:{"Content-Type":void 0,"Process-Data":!1}}).then(function(a){o.loading=!1,console.log("profile changed"),e.showmsg=!0,e.formdisable=!0,c("Username and Password changed.","sm"),e.newuser={},u(),e.newuser.username=e.curuser,e.formdisable=!1},function(a){o.loading=!1,e.showerror=!0,c("Try again later.","sm"),e.newuser={},u(),e.newuser.username=e.curuser,e.formdisable=!1})},e.cancel=function(){l.location.href="/#"},e.today=function(){e.date=new Date},e.today(),e.clear=function(){e.date=null},e.inlineOptions={customClass:function(a){var n=a.date;if("day"===a.mode)for(var o=new Date(n).setHours(0,0,0,0),t=0;t<e.events.length;t++)if(o===new Date(e.events[t].date).setHours(0,0,0,0))return e.events[t].status;return""},minDate:new Date,showWeeks:!0},e.dateOptions={formatYear:"yy",maxDate:new Date(2020,5,22),minDate:new Date,startingDay:1},e.toggleMin=function(){e.inlineOptions.minDate=e.inlineOptions.minDate?null:new Date,e.dateOptions.minDate=e.inlineOptions.minDate},e.toggleMin(),e.open1=function(){e.popup1.opened=!0},e.open2=function(){e.popup2.opened=!0},e.setDate=function(a,n,o){e.date=new Date(a,n,o)},e.formats=["dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],e.format=e.formats[0],e.altInputFormats=["M!/d!/yyyy"],e.popup1={opened:!1},e.popup2={opened:!1};var g=new Date;g.setDate(g.getDate()+1);var p=new Date;p.setDate(g.getDate()+1),e.events=[{date:g,status:"full"},{date:p,status:"partially"}]}]),app.controller("galleryController",["$scope","$http","$rootScope","$location","Upload","$timeout","$filter","$uibModal","$log","$document",function(e,a,n,o,t,l,r,i,s,d){function u(){a.get(n.base_url+"admin/gallery/get").then(function(a){console.log(a.data),a.data?(e.galleries=a.data,e.showtable=!0):(console.log("No data Found"),e.showtable=!1,e.message="No data found")})}e.galleries=[],e.newgallery={},e.curgallery={},e.files=[],e.errFiles=[],e.showform=!1,e.message={},n.url=o.path().replace("/",""),e.uploaded=[],e.fileValidation={},u(),e.newGallery=function(){e.newgallery={},e.filespre=[],e.uploaded=[],e.files=[],e.errFiles=[],e.showform=!0,e.item_files=!1},e.showForm=function(a){console.log(a),e.showform=!0,e.curgallery=a,e.newgallery=angular.copy(a),e.item_files=a.files},e.hideForm=function(){e.errFiles="",e.showform=!1},e.addGallery=function(){n.loading=!0;var o=new FormData;if(angular.forEach(e.newgallery,function(e,a){o.append(a,e)}),o.append("uploaded",JSON.stringify(e.uploaded)),e.newgallery.id){t=n.base_url+"admin/gallery/edit/"+e.newgallery.id;a.post(t,o,{transformRequest:angular.identity,headers:{"Content-Type":void 0,"Process-Data":!1}}).then(function(a){e.newgallery={},e.showform=!1,n.loading=!1,e.files=""},function(a){console.log("edit Error :- Status :"+a.status+"data : "+a.data),n.loading=!1,e.files=""})}else{var t=n.base_url+"admin/gallery/add";a.post(t,o,{transformRequest:angular.identity,headers:{"Content-Type":void 0,"Process-Data":!1}}).then(function(a){e.newgallery={},e.showform=!1,n.loading=!1,e.files=""},function(a){console.log("addError :- Status :"+a.status+"data : "+a.data),console.log(a.data),n.loading=!1,e.files="",403==a.status&&(e.fileValidation.status=!0,e.fileValidation.msg=a.data.validation_error)})}},e.deleteGallery=function(o){n.loading=!0;var t=n.base_url+"admin/gallery/delete/"+o.id;a.delete(t).then(function(a){var t=e.galleries.indexOf(o);e.galleries.splice(t,1),alert(a.data.msg),u(),n.loading=!1},function(e){console.log("Delete Error :- Status :"+e.status+"data : "+e.data),console.log(e.data),n.loading=!1})},e.uploadFiles=function(a,o){angular.forEach(o,function(a){e.errFiles.push(a)}),angular.forEach(a,function(a){e.files.push(a),a.upload=t.upload({url:n.base_url+"admin/gallery/upload",data:{file:a}}),a.upload.then(function(n){l(function(){e.uploaded.push(n.data),a.result=n.data})},function(a){a.status>0&&(e.errorMsg=a.status+": "+a.data)},function(e){a.progress=Math.min(100,parseInt(100*e.loaded/e.total))})})},e.deleteImage=function(o){n.loading=!0;var t=n.base_url+"admin/gallery/delete-image/"+o.id;a.delete(t).then(function(a){console.log("image deleted");var t=e.item_files.indexOf(o);e.item_files.splice(t,1),n.loading=!1},function(e){console.log("Delete Error :- Status :"+e.status+"data : "+e.data),console.log(e.data),n.loading=!1})},e.showGalleryFiles=function(a){console.log(a),e.galleryfiles=a},e.animationsEnabled=!0,e.open=function(a,n,o){var t=o?angular.element(d[0].querySelector(".modal-demo "+o)):void 0;i.open({animation:e.animationsEnabled,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"myModalContent.html",controller:"ModalInstanceCtrl",controllerAs:"$scope",size:n,appendTo:t,resolve:{items:function(){return a}}}).result.then(function(a){e.selected=a},function(){s.info("Modal dismissed at: "+new Date)})}}]);